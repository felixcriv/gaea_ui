<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-ajax/core-ajax.html">

<polymer-element name="events-service" attributes="events">
    <template>
        <style>
        :host {
            display: none;
        }
        </style>
        <core-ajax id="ajax" auto url="https://gaea.herokuapp.com/events" handleAs="json" on-core-response="{{handleResponse}}">
        </core-ajax>
    </template>
    <script>
    //adding some ideas from http://www.tutorialsavvy.com/2014/07/understanding-polymer-core-ajax-element.html
    Polymer('events-service', {

        created: function() {
            this.events = [];
        },

        handleResponse: function(data) {
            
            var e = data.detail.response.events;
            
            if (Object.keys(e).length) {         
                this.events = e;
                var spinner = document.querySelector('paper-spinner');
                spinner.active = false;
            } else {
                spinner.active = false;
                alert('There is not registered events for the past 24 hours');
            }
        },
    });
    </script>
</polymer-element>